var spinner,util={};function logout_event(){$("a.confirm-logout").click(function(){return Confirm("Bạn có muốn thoát không?","Xác nhận",function(t){t&&(window.location.href="/user/logout")}),!1})}function ShowMessError(t){var n=$(".div_msg_error");""==t?$(".div_msg_error .content").text("Timeout"):$(".div_msg_error .content").text(t),n.fadeIn("slow");var e=o();function o(){return setTimeout(function(){n.fadeOut("slow")},5e3)}n.mouseover(function(){e&&clearTimeout(e)}),n.mouseout(function(){e=o()})}util.isOnlyNumber=function(t){return/^\d$/.test(t)},util.isNumber=function(t){return/^(\-)?\d+(\.\d+)?$/.test(t)},util.isInt=function(t){return/^(\-)?\d+$/.test(t)},util.isPhoneNumber=function(t){return/^0(9\d{8}|1\d{9})$/.test(t)},util.isEmail=function(t){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t)},util.isUsername=function(t){return/^[a-z][a-z0-9_]{5,29}$/.test(t)},util.isPassword=function(t){return/^.{6,30}$/.test(t)},util.isNameVi=function(t){return/[a-zA-Z áàảãạăâắằấầặẵẫậéèẻẽẹêếềểễệóòỏõọôốồổỗộơớờởỡợíìỉĩịđùúủũụưứửữựÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼÊỀỂỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỨỪỬỮỰỲỴÝỶỸửữựỵỷỹ]{2,30}/.test(t)},util.isValidDate=function(t){if(!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(t))return!1;var n=t.split("/"),e=parseInt(n[0],10),o=parseInt(n[1],10),r=parseInt(n[2],10);if(r<1e3||3e3<r||0==o||12<o)return!1;var i=[31,28,31,30,31,30,31,31,30,31,30,31];return(r%400==0||r%100!=0&&r%4==0)&&(i[1]=29),0<e&&e<=i[o-1]},util.isValidDate2=function(t){if(!/^\d{4}\-\d{2}\-\d{2}$/.test(t))return!1;var n=t.split("-"),e=parseInt(n[0],10),o=parseInt(n[1],10),r=parseInt(n[2],10);if(e<1e3||3e3<e||0==o||12<o)return!1;var i=[31,28,31,30,31,30,31,31,30,31,30,31];return(e%400==0||e%100!=0&&e%4==0)&&(i[1]=29),0<r&&r<=i[o-1]},util.replaceHtml=function(t){return t?t.replace(/>/g,"&gt;").replace(/</g,"&lt;"):""},util.StringFormat=function(t,n){if(t&&n&&n.length&&0<n.length&&"string"==typeof t)for(var e=0;e<n.length;e++)t=t.replace("{"+e+"}",n[e]);return t},util.DateShow=function(t){if(t&&arg&&arg.length&&0<arg.length&&"string"==typeof t)for(var n=0;n<arg.length;n++)t=t.replace("{"+n+"}",arg[n]);return t},util.parseInt=function(t,n){return/^(\-)?\d+(\.\d+)?$/.test(t)?parseInt(t):n||0},util.parseNumber=function(t,n){return/^(\-)?\d+(\.\d+)?$/.test(t)?parseFloat(t):n||0},util.parseJson=function(t){try{return JSON.parse(t)}catch(t){return null}},util.toString=function(t,n){return t?String(t):n||""},util.formatNum=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},util.parseDate=function(t,n){if(this.isValidDate(t)){var e=t.split("/"),o=parseInt(e[0],10),r=parseInt(e[1],10),i=parseInt(e[2],10);return new Date(i,r,o)}return n||null},util.dateShow=function(t){if(t){var n=t.getFullYear(),e=t.getMonth()+1,o=t.getDate();return e<10&&(e="0"+e),o<10&&(o="0"+o),o+"/"+e+"/"+n}return""},util.date2String=function(t){if(t){var n=t.getFullYear(),e=t.getMonth()+1,o=t.getDate(),r=t.getHours(),i=t.getMinutes(),a=t.getSeconds();return e<10&&(e="0"+e),o<10&&(o="0"+o),r<10&&(r="0"+r),i<10&&(i="0"+i),a<10&&(a="0"+a),n+"-"+e+"-"+o+" "+r+":"+i+":"+a}return""},util.date2String2=function(t){if(t){var n=t.getFullYear(),e=t.getMonth()+1,o=t.getDate(),r=t.getHours(),i=t.getMinutes(),a=t.getSeconds();return e<10&&(e="0"+e),o<10&&(o="0"+o),r<10&&(r="0"+r),i<10&&(i="0"+i),a<10&&(a="0"+a),n+""+e+o+r+i+a}return""},util.date2String3=function(t){if(t){var n=t.getFullYear(),e=t.getMonth()+1,o=t.getDate();return e<10&&(e="0"+e),o<10&&(o="0"+o),o+"/"+e+"/"+n}return""},util.date2String4=function(t){if(t){var n=t.getFullYear(),e=t.getMonth()+1,o=t.getDate(),r=t.getHours(),i=t.getMinutes(),a=t.getSeconds();return e<10&&(e="0"+e),o<10&&(o="0"+o),r<10&&(r="0"+r),i<10&&(i="0"+i),a<10&&(a="0"+a),r+":"+i+":"+a+" "+o+"/"+e+"/"+n}return""},util.Second2Minute=function(t){var n=Math.floor(t/60),e=0;60<n&&(n-=60*(e=Math.floor(n/60)));var o=t-3600*e-60*n;return n<10&&(n="0"+n),o<10&&(o="0"+o),(0<e?e+":":"")+n+":"+o},util.randomString=function(t){var n="0123456789abcdefghijklmnopqrstuvwxyz",e=n.length,o="";for(i=0;i<t;i++)o+=n[Math.round(Math.random()*e)];return o},util.RankScore=function(t,n){if(t&&n){var e=[];for(i=0;i<t.length;i++)for(j=0;j<n.length;j++){var o=n[j];if(o._id==t[i]){e.push(o),n.splice(j,1);break}}return e}return null},util.ReadLocalStore=function(t,n){try{if(window.localStorage){var e=window.localStorage.getItem(t);return e||n}return console.log("localStorage not suport this web browser"),n||null}catch(t){return console.log(t.task),null}},util.SaveLocalStore=function(t,n){try{if(window.localStorage){n=JSON.stringify(n);window.localStorage.setItem(t,n)}else console.log("localStorage not suport this web browser")}catch(t){console.log(t.task)}},util.DelLocalStore=function(t){try{window.localStorage?window.localStorage.removeItem(t):console.log("localStorage not suport this web browser")}catch(t){console.log(t.task)}},util.RankScore=function(t,n){if(t&&n){var e=[];for(i=0;i<t.length;i++)for(j=0;j<n.length;j++){var o=n[j];if(o._id==t[i]){e.push(o),n.splice(j,1);break}}return e}return null},util.GenPageJs=function(t,n,e,o,r,i,a,u){if($numberpage=0,$numberpage=t%n==0?Math.floor(t/n):Math.floor(t/n)+1,1==$numberpage)return"";for($loopend=0,$loopstart=0,$istart=!1,$iend=!1,0==e?($loopstart=0,$loopend=$numberpage>i-1?i:$numberpage,$numberpage>i&&($iend=!0)):e<$numberpage-(i-1)&&0!=e?($loopstart=e-1,$loopend=e+(i-1),$iend=!0,1<e&&($istart=!0)):(0<$numberpage-i?($loopstart=$numberpage-i,$istart=!0):$loopstart=0,$loopend=$numberpage),$sPage='<ul class="'+o+'">',$istart&&($sPage+='<li><a onclick="javascript:'+a+"(0,"+u+')" href="javascript:void(0);"><i class="fa fa-fast-backward"></i></a></li>'),1<=e&&($sPage+='<li><a onclick="javascript:'+a+"("+(e-1)+","+u+')" href="javascript:void(0);"><i class="fa fa-step-backward"></i></a></li>'),$i=$loopstart;$i<$loopend;$i++)e==$i?$sPage+='<li><a class="'+r+'" href="javascript:void(0);">':$sPage+='<li><a onclick="javascript:'+a+"("+$i+","+u+')" href="javascript:void(0);">',$sPage+=$i+1+"</a></li>";return e<=$numberpage-2&&($sPage+='<li><a onclick="javascript:'+a+"("+(e+1)+","+u+')" href="javascript:void(0);" ><i class="fa fa-step-forward"></i></a></li>'),$iend&&($sPage+='<li><a onclick="javascript:'+a+"("+($numberpage-1)+","+u+')" href="javascript:void(0);" ><i class="fa fa-fast-forward"></i></a></li>'),$sPage+="</ul>",$sPage},util.randomSelect=function(t){options=$(t+" > option");var n=Math.floor(Math.random()*options.length);return options[n].selected=!0,n},util.POST=function(t,n,e){e=e||"post";var o=document.createElement("form");for(var r in o.setAttribute("method",e),o.setAttribute("action",t),n)if(n.hasOwnProperty(r)){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",r),i.setAttribute("value",n[r]),o.appendChild(i)}document.body.appendChild(o),o.submit()},Number.prototype.format=function(t,n){var e="\\d(?=(\\d{"+(n||3)+"})+"+(0<t?"\\.":"$")+")";return this.toFixed(Math.max(0,~~t)).replace(new RegExp(e,"g"),"$&,")},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),$(function(){for(var t in spinner=$("#spinner"),$("a.tn-late-visit").click(function(){return TN_POPUP.show("Chuyên mục này đang được phát triển<br/>Bạn hãy ghé thăm vào 20/11<br/>-=Xin cảm ơn=-","Xin lỗi"),!1}),$("a.must-login").click(function(){var t=$(this);if(!window.is_login){var n=[{caption:"Đăng nhập",callback:function(){window.next_url=t.attr("href"),$(".cd-signin").trigger("click")}},{caption:"Bỏ qua",callback:function(){window.next_url=void 0}}];return TN_POPUP.show("Bạn cần phải đăng nhập<br/>trước khi thực hiện thao tác này",null,null,null,n),!1}}),$("a.exam-not-enable").click(function(){var t=$(this).attr("score");return""==t?TN_POPUP.show("Bạn chưa qua bài trước"):TN_POPUP.show("Bạn đã thi bài này với số điểm: "+t),!1}),$("a.round-not-open").click(function(){return TN_POPUP.show("Vòng này chưa được mở"),!1}),$(".num-format").each(function(){var t=$(this),n=parseInt(t.text());n=util.formatNum(n),t.text(n)}),logout_event(),$.cookie())$.removeCookie(t)}),$.ajaxSetup({type:"GET",timeout:3e4,beforeSend:function(t){t.setRequestHeader("x-position","object"==typeof window.position?JSON.stringify({accuracy:window.position.accuracy,latitude:window.position.latitude,longitude:window.position.longitude,speed:window.position.speed}):window.position),spinner&&spinner.show()},statusCode:{200:function(){},404:function(){},500:function(){}},error:function(t,n,e){console.log(t,n,e),ShowMessError(e)},success:function(t,n,e){},complete:function(t,n){spinner&&spinner.hide()}});var TN_POPUP={control:{div:$("#modal-message"),title:$("#modal-message .modal-title"),content:$("#modal-message .tn-popup-content"),footer:$("#modal-message .tn-popup-footer")},modal:$("#modal-message").modal({show:!1,keyboard:!0,backdrop:"static"}),show:function(t,n,e,o,r,i,a){TN_POPUP.tClose&&(clearTimeout(TN_POPUP.tClose),delete TN_POPUP.tClose),TN_POPUP.control.content.html(t),TN_POPUP.control.title.text(n||"Thông báo");var u=TN_POPUP.control.footer.html("");if(r&&0<r.length){for(var l=0;l<r.length;l++){button=r[l];var c=button.auto_callback?'auto-callback="true"':"";$button=$('<a href="javascript:void(0);" '+c+' btn-index="'+l+'" class="btn btn-red" style="min-width: 100px; display: inline-block; margin: 0 5px;">'+button.caption+"</a>"),button.auto_callback&&(button.timeout=setTimeout(function(){var t=parseInt($(".tn-btn-popup[auto-callback=true]").attr("btn-index")),n=r[t].callback;n&&n(),TN_POPUP.hide()},button.auto_callback)),$button.click(function(){button.timeout&&clearTimeout(button.timeout);var t=parseInt($(this).attr("btn-index")),n=r[t].callback;n&&n(),TN_POPUP.hide()}),u.append($button)}TN_POPUP.timeout&&(clearTimeout(TN_POPUP.timeout),TN_POPUP.timeout=void 0),i&&(TN_POPUP.timeout=setTimeout(function(){TN_POPUP.hide()},i))}else $botton_default=$('<a href="javascript:void(0);" class="btn btn-red"  style="min-width: 100px; display: inline-block; margin: 0 5px;">Ok</a>'),$botton_default.click(function(){TN_POPUP.hide()}),u.append($botton_default);TN_POPUP.control.div.is(":visible")||TN_POPUP.modal.modal("show")},hide:function(){TN_POPUP.tClose=setTimeout(function(){TN_POPUP.modal.modal("hide")},200)}};function goToByScroll(t){t=t.replace("link",""),$("html,body").animate({scrollTop:$(t).offset().top},"slow")}function SortArray(t,n,e){if(t&&0<t.length){for(var o=t.length,r=[],i=0;i<o;i++){var a=t[0][n],u=0;for(j=1;j<o-i;j++){var l=t[j];e?a>l[n]&&(a=l[n],u=j):a<l[n]&&(a=l[n],u=j)}r.push(t[u]),t.splice(u,1)}return r}return null}$(function(){TN_POPUP.control={div:$("#modal-message"),title:$("#modal-message .modal-title"),content:$("#modal-message .tn-popup-content"),footer:$("#modal-message .tn-popup-footer")},TN_POPUP.modal=$("#modal-message").modal({show:!1,keyboard:!0,backdrop:"static"})}),window.Confirm=function(t,n,e){var o=[{caption:"Đồng ý",callback:function(){e(!0)}},{caption:"Hủy",callback:function(){e(!1)}}];TN_POPUP.show(t,n,null,null,o)},jQuery.fn.ForceNumericOnly=function(){return this.each(function(){$(this).keydown(function(t){var n=t.charCode||t.keyCode||0;return 8==n||9==n||13==n||46==n||110==n||190==n||35<=n&&n<=40||48<=n&&n<=57||96<=n&&n<=105})})};var Urllib={encode:function(t){return encodeURIComponent(t)},decode:function(t){return decodeURIComponent(t)},GetQueryString:function(){for(var t,n=[],e=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),o=0;o<e.length;o++)t=e[o].split("="),n.push(t[0]),n[t[0]]=unescape(t[1]);return n},getIsMobileClient:function(t){for(var n=navigator.userAgent.toLowerCase(),e=["android","windows ce","blackberry","palm","mobile"],o=0;o<e.length;o++)if(-1<n.indexOf(e[o]))return!t||e[o].toUpperCase()==t.toUpperCase();return!1}};$(document).on("keydown",function(t){8!==t.which||$(t.target).is("input, textarea")||t.preventDefault()}),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){window.position=t.coords},function(t){window.position=-1}):window.position=0;